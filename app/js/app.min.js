angular.module("equipmentsApp.controllers",["ngResource","appMaps"]).controller("EquipmentsController",function(a,b,c,d){a.mapPromise=d.getLocation(),a.mapPromise.then(function(){var b=d.getCurrentLat(),e=d.getCurrentLon(),f=c("https://api.paris.fr/api/data/1.1/Equipements/get_geo_equipements/?:path",{path:"@path"}),g=c("https://api.paris.fr/api/data/1.0/Equipements/get_equipement/?:path",{path:"@path"});f.get({path:"token=ec8492667356ee806e5de5d0d322a51708b094a75abf07b0024edfa09ca25aa1&cid=27,29&offset=0&limit=10&lat="+b+"&lon="+e+"&radius=10000"},function(b){a.equipments=b.data,angular.forEach(a.equipments,function(a,b){setTimeout(function(){var b=a.id;g.get({path:"token=ec8492667356ee806e5de5d0d322a51708b094a75abf07b0024edfa09ca25aa1&id="+b},function(b){a.latitude=b.data[0].lat,a.longitude=b.data[0].lon})},200*b)})})})}),angular.module("appMaps",["uiGmapgoogle-maps"]).controller("MapController",function(a,b,c,d){a.mapPromise.then(function(){var b=c.getCurrentLat(),d=c.getCurrentLon();a.map={center:{latitude:b,longitude:d},zoom:15}}),a.favoritesMarkers=[];var e=[];a.$watch(function(){return d.getFavorites()},function(){e=[];for(var b=0;b<d.getFavorites().length;b++)e.push({id:b+1,latitude:d.getFavorites()[b].latitude,longitude:d.getFavorites()[b].longitude,name:d.getFavorites()[b].name});a.favoritesMarkers=e},!0)}),angular.module("equipmentsApp",["equipmentsApp.controllers","favoriteFilter","uiGmapgoogle-maps","appMaps"]),angular.module("favoriteFilter",[]).filter("favorite",function(a){return function(b){var c,d=[];if(b){for(c=0;c<b.length;c++)b[c].checked&&d.push(b[c]);a.setFavorites(d)}else console.log("Problème dans l'exécution du filtre (Problème avec l'API de Paris)");return d}}),angular.module("equipmentsApp").factory("getCurrentLocation",["$q",function(a){function b(a){c=a.coords.latitude,d=a.coords.longitude}var c=0,d=0,e=function(){return e.deferred=a.defer(),navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){b(a),e.deferred.resolve()}):($("body").append("Geolocation is not supported by this browser."),e.deferred.reject("Ca ne MARCHE PAS !")),e.deferred.promise},f=function(){return c},g=function(){return d},h=function(){var a={center:{latitude:c,longitude:d},zoom:15};return a};return{getLocation:e,getCurrentLat:f,getCurrentLon:g,getInitMat:h}}]),angular.module("equipmentsApp").service("favoritesManager",[function(){var a=[];this.getFavorites=function(){return a},this.setFavorites=function(b){a=b}}]);