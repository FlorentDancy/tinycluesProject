angular.module("equipmentsApp.controllers",["ngResource","appMaps"]).controller("equipmentsController",function(a,b,c,d){var e=c("https://api.paris.fr/api/data/1.1/Equipements/get_geo_equipements/?:path",{path:"@path"}),f=c("https://api.paris.fr/api/data/1.0/Equipements/get_equipement/?:path",{path:"@path"});d.getLocation().then(function(){var b=d.getCurrentLat(),c=d.getCurrentLon();e.get({path:"token=ec8492667356ee806e5de5d0d322a51708b094a75abf07b0024edfa09ca25aa1&cid=27,29&offset=0&limit=10&lat="+b+"&lon="+c+"&radius=2000"},function(b){a.equipments=b.data,angular.forEach(a.equipments,function(a,b){setTimeout(function(){var b=a.id;f.get({path:"token=ec8492667356ee806e5de5d0d322a51708b094a75abf07b0024edfa09ca25aa1&id="+b},function(b){a.latitude=b.data[0].lat,a.longitude=b.data[0].lon})},200*b)})})})}),angular.module("appMaps",["uiGmapgoogle-maps"]).controller("mapCtrl",function(a,b,c,d){c.getLocation().then(function(){var b=c.getCurrentLat(),d=c.getCurrentLon();a.map={center:{latitude:b,longitude:d},zoom:15}}),a.favoritesMarkers=[];var e=[];a.$watch(function(){return d.getFavorites()},function(){console.log("Y'a du changement"),e=[];for(var b=0;b<d.getFavorites().length;b++)e.push({id:b+1,latitude:d.getFavorites()[b].latitude,longitude:d.getFavorites()[b].longitude,name:d.getFavorites()[b].name});a.favoritesMarkers=e},!0)}),angular.module("equipmentsApp",["equipmentsApp.controllers","favoriteFilter","uiGmapgoogle-maps","appMaps"]),angular.module("favoriteFilter",[]).filter("favorite",function(a){return function(b){var c,d=[];for(c=0;c<b.length;c++)b[c].checked&&d.push(b[c]);return a.setFavorites(d),d}}),angular.module("equipmentsApp").factory("getCurrentLocation",["$q",function(a){function b(a,b){c=a.coords.latitude,d=a.coords.longitude,b.resolve("coucou")}var c=0,d=0,e=function(){return e.deferred=a.defer(),navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){b(a,e.deferred)}):$("body").append("Geolocation is not supported by this browser."),e.deferred.promise},f=function(){return c},g=function(){return d};return{getLocation:e,getCurrentLat:f,getCurrentLon:g}}]),angular.module("equipmentsApp").service("favoritesManager",[function(){var a=[];this.getFavorites=function(){return a},this.setFavorites=function(b){a=b},this.pushFavorites=function(b){a.push(b)}}]);